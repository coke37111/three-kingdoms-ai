# 차별점 및 혁신 요소

## 개요

이 프로젝트는 **AI 네이티브 게임**. LLM이 게임의 중심에 있으며, 전통적인 게임에서 개발자가 미리 설계하는 요소들을 AI가 실시간으로 생성.

**AI 네이티브 게임의 정의**: LLM을 **게임 마스터(Game Master)**로 활용하여, 스토리텔링, NPC 행동 결정, 참모 회의 진행, 플레이어와의 대화를 모두 AI가 담당하는 게임.

## 일반 전략 게임과의 차별점

### 1. 참모 회의 기반 전략 수립

전통적인 전략 게임은 메뉴 클릭으로 행동을 선택하지만, 이 게임은:

- **4인 참모 회의**: 각 참모가 자기 전문 분야(전략/군사/외교/내정)에서 자율적으로 현황 보고 및 계획 수립
- **5-Phase 시스템**: 상태보고→토론→계획→피드백→실행의 구조적 회의 진행
- **자유 대화**: 제시된 보고에 대해 자연어로 자유롭게 토론하거나 방향 제시

**코드 근거**: `lib/prompts/councilPrompt.ts`의 `buildPhase1And3Prompt()` 함수가 전체 게임 상태와 참모 정보를 AI에게 전달하고, AI는 `CouncilResponse` 형태로 상태 보고 + 계획 보고를 생성.

### 2. NPC의 지능적 행동

- **성격 기반 의사결정**: 각 세력 군주는 고유한 성격(공격성, 외교성, 개발성, 모험성)을 가지며, 이를 기반으로 행동 결정
  - 조조: 공격적이고 야심찬 확장주의자 (aggression: 80)
  - 손권: 신중하고 방어적인 균형론자 (diplomacy: 75)

- **포인트 기반 전략**: NPC는 현재 AP/SP/MP/IP/DP 상태, 성채 배치, 외교 관계를 종합적으로 분석하여 행동 결정

- **배치 처리 최적화**: 2개 NPC 세력의 행동을 하나의 API 호출로 동시 처리

**코드 근거**: `lib/prompts/factionAIPrompt.ts`의 `buildFactionAIPrompt()` 함수

### 3. 대화 + 게임 메커니즘의 통합

- **구조화된 AI 응답**: AI는 자연스러운 대화(`council_messages`)와 게임 상태 변경(`state_changes`)을 동시에 JSON 형태로 반환
- **포인트 연동**: AI 대화의 결과가 즉시 포인트 변동으로 반영
- **캐릭터 일관성**: 4인 참모 각각의 페르소나가 모든 응답에서 유지

### 4. 포인트 시스템으로 전략적 추상화

- **5종 포인트**: AP(발언 기회), SP(기술 연구), MP(군사력), IP(내정/경제), DP(외교) 각각 다른 전략적 의미
- **AP 기반 토론**: 발언 자체가 자원 소비 — 무엇을 말하고 무엇을 생략할지가 전략적 선택
- **MP 산출 공식**: troops × training × morale로 단순 병력 수 이상의 군사력 표현

## 기존 삼국지 게임 비교

| 요소 | 일반 삼국지 게임 | 이 게임 |
|------|-----------------|---------|
| **시나리오** | 고정된 역사 이벤트 | AI가 실시간 생성하는 동적 상황 |
| **조작 방식** | 메뉴/버튼 클릭 | 참모 회의 + 자연어 대화 |
| **NPC 행동** | 고정 패턴 또는 룰 기반 | 성격 + 상황 분석 기반 AI 의사결정 |
| **자원 시스템** | 금/식량/병력 직접 관리 | 5종 포인트 추상화, AI가 세부 운영 |
| **확장성** | DLC/패치 필요 | AI 모델 업데이트만으로 개선 |
| **대화** | 스크립트화된 대사 | 자유로운 토론과 방향 제시 |

## 기술적 근거

### 주요 파일

1. **`lib/prompts/councilPrompt.ts`**
   - 4인 참모 캐릭터 정의 및 페르소나 강제
   - 포인트/성채 현황 전달
   - Phase 1+3/Phase 2/Phase 4 프롬프트 구축

2. **`lib/prompts/factionAIPrompt.ts`**
   - NPC 행동 결정 프롬프트
   - 배치 처리 구조 (2개 세력 동시)
   - 성격 기반 의사결정 가이드

3. **`lib/api/llmClient.ts`**
   - JSON 파싱 복구 (괄호 균형/후행 쉼표)
   - 발언자 다양성 보장 (ADVISOR_KEYWORDS)
   - 모델별 API 호출 추상화

4. **`components/game/GameContainer.tsx`**
   - 5-Phase 게임 루프 오케스트레이션
   - AP 소비/복구 관리
   - NPC 턴 처리
   - 상태 자동 저장

### 세력별 AI 페르소나

**조조 (Cao Cao)**
```
성격: 공격성 80, 외교성 50, 개발성 60, 모험성 70
전략: 야심찬 확장주의, 약한 세력 우선 공격
24개 성채, 60만 병력, 군주 레벨 20
```

**손권 (Sun Quan)**
```
성격: 공격성 40, 외교성 75, 개발성 75, 모험성 35
전략: 신중한 균형론, 경제 발전 우선
9개 성채, 20만 병력, 군주 레벨 8
```

## 결론

이 프로젝트는 **LLM을 게임 디자인의 중심에 배치**한 혁신적 시도.

### 장점
- 무한한 재플레이성 (매번 다른 참모 회의)
- 자연스러운 인터랙션 (자유 대화)
- 지능적인 NPC (포인트 기반 전략적 AI)
- 포인트 추상화로 "대화 자체가 게임"

### 도전과제
- API 비용 관리
- AI 응답 안정성 확보
- 게임 밸런스 유지
- 캐릭터 일관성 유지
